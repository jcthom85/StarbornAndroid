[
    {
        "id": "nova_house_light_toggle",
        "description": "Toggle the lights in Nova's House.",
        "trigger": {
            "type": "player_action",
            "action": "toggle_nova_house_light"
        },
        "actions": [
            {
                "room_id": "town_9",
                "state_key": "light_on",
                "type": "toggle_room_state"
            }
        ],
        "repeatable": true,
        "on_message": "You flip the switch. The lights come on.",
        "off_message": "You flip the switch. The room goes dark."
    },
    {
        "id": "enter_letterbox_room",
        "description": "Letterbox demo on entry.",
        "trigger": {
            "type": "enter_room",
            "room": "letterbox_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "letterbox_demo"
            }
        ]
    },
    {
        "id": "enter_flash_room",
        "description": "Flash demo.",
        "trigger": {
            "type": "enter_room",
            "room": "flash_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "flash_demo"
            }
        ]
    },
    {
        "id": "enter_color_filter_room",
        "description": "Color filter demo.",
        "trigger": {
            "type": "enter_room",
            "room": "color_filter_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "color_filter_demo"
            }
        ]
    },
    {
        "id": "enter_flashback_room",
        "description": "Flashback demo.",
        "trigger": {
            "type": "enter_room",
            "room": "flashback_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "flashback_demo"
            }
        ]
    },
    {
        "id": "enter_speed_lines_room",
        "description": "Speed lines demo.",
        "trigger": {
            "type": "enter_room",
            "room": "speed_lines_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "speed_lines_demo"
            }
        ]
    },
    {
        "id": "enter_ring_room",
        "description": "Ring demo.",
        "trigger": {
            "type": "enter_room",
            "room": "ring_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "ring_demo"
            }
        ]
    },
    {
        "id": "enter_vignette_room",
        "description": "Vignette demo.",
        "trigger": {
            "type": "enter_room",
            "room": "vignette_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "vignette_demo"
            }
        ]
    },
    {
        "id": "enter_shake_room",
        "description": "Shake demo.",
        "trigger": {
            "type": "enter_room",
            "room": "shake_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "shake_demo"
            }
        ]
    },
    {
        "id": "enter_fade_room",
        "description": "Fade demo.",
        "trigger": {
            "type": "enter_room",
            "room": "fade_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "fade_demo"
            }
        ]
    },
    {
        "id": "enter_zoom_room",
        "description": "Zoom-only demo.",
        "trigger": {
            "type": "enter_room",
            "room": "zoom_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "zoom_only_demo"
            }
        ]
    },
    {
        "id": "enter_pan_room",
        "description": "Pan-only demo.",
        "trigger": {
            "type": "enter_room",
            "room": "pan_room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "pan_only_demo"
            }
        ]
    },
    {
        "id": "enter_caption_studio_single",
        "description": "Single caption demo.",
        "trigger": {
            "type": "enter_room",
            "room": "caption_studio"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "caption_demo"
            }
        ]
    },
    {
        "id": "enter_market_plaza_intro",
        "description": "Short intro when entering the market plaza.",
        "trigger": {
            "type": "enter_room",
            "room": "market_plaza"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "market_plaza_intro"
            }
        ]
    },
    {
        "id": "enter_town_square_intro",
        "description": "Short intro when entering the residential square.",
        "trigger": {
            "type": "enter_room",
            "room": "town_square"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "town_square_intro"
            }
        ]
    },
    {
        "id": "market_dock_lost_crate",
        "description": "Spawn a Medkit at the loading dock as a lightweight pickup.",
        "trigger": {
            "type": "enter_room",
            "room": "market_loading_dock"
        },
        "actions": [
            {
                "type": "spawn_item",
                "room_id": "market_loading_dock",
                "item": "Medkit"
            }
        ]
    },
    {
        "id": "enter_vfx_stage_showcase",
        "description": "Auto-run VFX showcase when entering the VFX Stage.",
        "trigger": {
            "type": "enter_room",
            "room": "vfx_stage"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "vfx_stage_demo"
            }
        ]
    },
    {
        "id": "enter_wipe_lab_demo",
        "description": "Demonstrates bar wipe variants.",
        "trigger": {
            "type": "enter_room",
            "room": "wipe_lab"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "wipe_demo"
            }
        ]
    },
    {
        "id": "enter_particles_bay_demo",
        "description": "Particles presets at the bay.",
        "trigger": {
            "type": "enter_room",
            "room": "particles_bay"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "particles_demo"
            }
        ]
    },
    {
        "id": "enter_camera_gallery",
        "description": "Camera moves demo.",
        "trigger": {
            "type": "enter_room",
            "room": "camera_gallery"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "camera_gallery_demo"
            }
        ]
    },
    {
        "id": "enter_tilt_suite",
        "description": "Tilt test.",
        "trigger": {
            "type": "enter_room",
            "room": "tilt_suite"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "tilt_demo"
            }
        ]
    },
    {
        "id": "enter_zoom_lounge",
        "description": "Zoom and pan test.",
        "trigger": {
            "type": "enter_room",
            "room": "zoom_lounge"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "zoom_pan_demo"
            }
        ]
    },
    {
        "id": "enter_caption_studio",
        "description": "Caption styles cycle.",
        "trigger": {
            "type": "enter_room",
            "room": "caption_studio"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "caption_cycle"
            }
        ]
    },
    {
        "id": "enter_narration_theatre",
        "description": "Narration panel demo.",
        "trigger": {
            "type": "enter_room",
            "room": "narration_theatre"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "narration_demo"
            }
        ]
    },
    {
        "id": "enter_cinematic_text_hall",
        "description": "Cinematic text bar demo.",
        "trigger": {
            "type": "enter_room",
            "room": "cinematic_text_hall"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "cinematic_text_demo"
            }
        ]
    },
    {
        "id": "key_spawns_drone",
        "description": "Small key triggers a two-drone ambush.",
        "trigger": {
            "type": "item_acquired",
            "item": "small key"
        },
        "actions": [
            {
                "type": "start_battle",
                "enemy_ids": [
                    "security_drone",
                    "security_drone"
                ]
            }
        ]
    },
    {
        "id": "drone_defeated_mechanic_dialogue",
        "description": "Mechanic thanks you\u2014and hints at a locked locker\u2014after the drone is destroyed.",
        "trigger": {
            "type": "enemy_defeated",
            "enemy": "security_drone"
        },
        "actions": [
            {
                "type": "update_npc_dialogue",
                "npc": "mechanic",
                "dialogue": "Great job taking down that drone! Now, if you find a small brass key, use it on the storage locker in the bedroom\u2014I really need the wrench inside."
            }
        ]
    },
    {
        "id": "start_find_wrench_on_talk",
        "trigger": {
            "type": "talk_to",
            "npc": "mechanic"
        },
        "actions": [
            {
                "type": "if_quest_status_is",
                "quest_id": "find_wrench",
                "status": "inactive",
                "do": [
                    {
                        "type": "start_quest",
                        "quest_id": "find_wrench"
                    }
                ]
            }
        ]
    },
    {
        "id": "unlock_locker",
        "trigger": {
            "type": "player_action",
            "action": "unlock_locker"
        },
        "actions": [
            {
                "type": "toggle_room_state",
                "room_id": "bedroom",
                "state_key": "locker_open"
            },
            {
                "type": "spawn_item",
                "room_id": "bedroom",
                "item": "wrench"
            }
        ]
    },
    {
        "id": "took_wrench",
        "trigger": {
            "type": "item_acquired",
            "item": "wrench"
        },
        "actions": [
            {
                "type": "toggle_room_state",
                "room_id": "bedroom",
                "state_key": "wrench_taken"
            }
        ]
    },
    {
        "id": "reset_mechanic_after_all",
        "trigger": {
            "type": "complete_quest",
            "quest_id": "return_wrench"
        },
        "actions": [
            {
                "type": "update_npc_dialogue",
                "npc": "mechanic",
                "dialogue": "after_all"
            }
        ]
    },
    {
        "id": "trigger_camera_test_in_tysons_room",
        "description": "Plays the camera test cinematic upon entering Tyson's room.",
        "trigger": {
            "type": "enter_room",
            "room": "tyson's room"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "camera_test"
            }
        ]
    },
    {
        "id": "trigger_vfx_showcase_in_shop",
        "description": "Runs the full VFX showcase when the player enters the shop.",
        "trigger": {
            "type": "enter_room",
            "room": "shop"
        },
        "actions": [
            {
                "type": "play_cinematic",
                "scene_id": "master_showcase"
            }
        ]
    },
    {
        "id": "ancient_drone_drops_inductor",
        "description": "The old drone drops its core component upon defeat.",
        "trigger": {
            "type": "enemy_defeated",
            "enemy": "drone_ancient"
        },
        "actions": [
            {
                "type": "give_item_to_player",
                "item": "Cryo-Inductor"
            }
        ]
    },
    {
        "id": "qpack_evt_relay_stage1_complete",
        "trigger": {
            "type": "quest_stage_complete",
            "quest_id": "q_mine_relay_scramble",
            "stage_id": "q_mine_relay_scramble:stage_1"
        },
        "actions": [
            {
                "type": "give_item",
                "item_id": "itm_noise_maker",
                "quantity": 1,
                "to_player": true,
                "note": "Gives a Noise Maker so the player can attempt a stealth bypass."
            },
            {
                "type": "advance_quest",
                "quest_id": "q_mine_relay_scramble",
                "to_stage_id": "q_mine_relay_scramble:stage_2"
            }
        ]
    },
    {
        "id": "qpack_evt_relay_stage2_complete",
        "trigger": {
            "type": "quest_stage_complete",
            "quest_id": "q_mine_relay_scramble",
            "stage_id": "q_mine_relay_scramble:stage_2"
        },
        "actions": [
            {
                "type": "spawn_encounter",
                "encounter_id": "enc_collapse_ambush",
                "room_id": "living",
                "condition": "if_player_timed_trap_or_disturbs_alcove"
            },
            {
                "type": "advance_quest",
                "quest_id": "q_mine_relay_scramble",
                "to_stage_id": "q_mine_relay_scramble:stage_3"
            }
        ]
    },
    {
        "id": "qpack_evt_relay_stage3_complete",
        "trigger": {
            "type": "quest_stage_complete",
            "quest_id": "q_mine_relay_scramble",
            "stage_id": "q_mine_relay_scramble:stage_3"
        },
        "actions": [
            {
                "type": "give_item",
                "item_id": "itm_stabilizer_plate",
                "quantity": 1,
                "to_player": true,
                "note": "A salvaged stabilizer plate needed for final assembly."
            },
            {
                "type": "advance_quest",
                "quest_id": "q_mine_relay_scramble",
                "to_stage_id": "q_mine_relay_scramble:stage_4"
            }
        ]
    },
    {
        "id": "qpack_evt_relay_stage4_complete",
        "trigger": {
            "type": "quest_stage_complete",
            "quest_id": "q_mine_relay_scramble",
            "stage_id": "q_mine_relay_scramble:stage_4"
        },
        "actions": [
            {
                "type": "grant_reward",
                "quest_id": "q_mine_relay_scramble",
                "xp": 420,
                "credits": 150,
                "items": [
                    {
                        "item_id": "itm_relay_prototype",
                        "quantity": 1
                    }
                ],
                "ap": 1
            },
            {
                "type": "trigger_cutscene",
                "cutscene_id": "cs_relay_final"
            },
            {
                "type": "complete_quest",
                "quest_id": "q_mine_relay_scramble"
            }
        ]
    },
    {
        "id": "qpack_evt_drone_sweep_victory",
        "trigger": {
            "type": "encounter_victory",
            "encounter_id": "enc_drone_sweep"
        },
        "actions": [
            {
                "type": "give_xp",
                "xp": 160
            },
            {
                "type": "unlock_room_search",
                "room_id": "living",
                "note": "Victory reveals a tucked maintenance alcove with salvageable bits."
            },
            {
                "type": "advance_quest_if_active",
                "quest_id": "q_mine_relay_scramble",
                "to_stage_id": "q_mine_relay_scramble:stage_3",
                "condition": "if_stage_eq:q_mine_relay_scramble:stage_2"
            }
        ]
    },
    {
        "id": "qpack_evt_collapse_ambush_victory",
        "trigger": {
            "type": "encounter_victory",
            "encounter_id": "enc_collapse_ambush"
        },
        "actions": [
            {
                "type": "give_xp",
                "xp": 320
            },
            {
                "type": "spawn_item_on_ground",
                "item_id": "itm_relay_fragment",
                "quantity": 1,
                "room_id": "living",
                "note": "Wyrm chest contains a relay fragment held in a stony cradle."
            },
            {
                "type": "advance_quest_if_active",
                "quest_id": "q_mine_relay_scramble",
                "to_stage_id": "q_mine_relay_scramble:stage_3",
                "condition": "if_stage_eq:q_mine_relay_scramble:stage_2"
            }
        ]
    },
    {
        "id": "qpack_evt_scout_reveal_hidden_fragment",
        "trigger": {
            "type": "npc_interaction",
            "npc_id": "scout_mekk",
            "interaction_type": "event"
        },
        "actions": [
            {
                "type": "reveal_hidden_item",
                "item_id": "itm_relay_fragment",
                "quantity": 1,
                "room_id": "living",
                "note": "Mekk points out a fragment tucked behind a weak panel."
            }
        ]
    },
    {
        "id": "test_main_road",
        "description": "Fire test cinematic",
        "trigger": {
            "type": "enter_room",
            "room": "town_8"
        },
        "actions": [
            {
                "scene_id": "test_main_road",
                "type": "play_cinematic"
            }
        ],
        "notes": "Test"
    },
    {
        "id": "debug_first_quest",
        "description": "DEBUG First Quest",
        "trigger": {
            "type": "enter_room",
            "room": "town_9"
        },
        "actions": [
            {
                "quest_id": "W1-H1-MAIN-01",
                "type": "start_quest"
            }
        ]
    }
]